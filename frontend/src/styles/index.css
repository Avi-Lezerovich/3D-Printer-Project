@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom layers remain for handcrafted tokens/utilities */
@layer reset, base, components, utilities;

@layer reset {
  *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
  html,body,#root{height:100%}
}

@layer base{
  :root{
    /* dark theme (default) */
    --bg:#0b1620; 
    --panel:#0d1d2b; 
    --muted:#7fb6e6; 
    --accent:#00aef0; 
    --accent-2:#004d7f; 
    --good:#37d67a; 
    --warn:#f5a623; 
    --bad:#f44336;
    --text:#e6f1ff;
    --text-soft:#c9e3ff;
    --text-secondary:#a1b4c6;
    --border:#123a56;
    --focus:#66ccff;
    
    /* RGB equivalents for alpha blending */
    --bg-rgb: 11, 22, 32;
    --panel-rgb: 13, 29, 43;
    --accent-rgb: 0, 174, 240;
    --text-rgb: 230, 241, 255;
    --text-secondary-rgb: 161, 180, 198;
    
    color-scheme: dark;
  }
  :root[data-theme='light']{
    --bg:#f6fbff; 
    --panel:#ffffff; 
    --muted:#335a77; 
    --accent:#006aa6; 
    --accent-2:#003a5c; 
    --good:#0a7d3b; 
    --warn:#b57000; 
    --bad:#b30000;
    --text:#0b1620;
    --text-soft:#163049;
    --text-secondary:#4a5568;
    --border:#cfe4f5;
    --focus:#007acc;
    
    /* RGB equivalents for alpha blending */
    --bg-rgb: 246, 251, 255;
    --panel-rgb: 255, 255, 255;
    --accent-rgb: 0, 106, 166;
    --text-rgb: 11, 22, 32;
    --text-secondary-rgb: 74, 85, 104;
    
    color-scheme: light;
  }
  body{
    font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    background:var(--bg);
    color:var(--text);
    line-height:1.6;
    font-feature-settings: 'cv01', 'cv02', 'cv03', 'cv04';
    font-weight: 400;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  h1,h2,h3,h4,h5,h6{color:var(--text-soft); margin-bottom: 0.5em;}
  h1 { font-size: 2.5rem; }
  h2 { font-size: 2rem; }
  h3 { font-size: 1.75rem; }
  h4 { font-size: 1.5rem; }
  h5 { font-size: 1.25rem; }
  h6 { font-size: 1rem; }

  p { margin-bottom: 1em; }

  a{color:var(--accent); text-underline-offset: 2px; text-decoration-thickness: 1px}
  a:hover{color:var(--accent-2); text-decoration-thickness: 2px}
  
  /* Enhanced focus indicators for accessibility */
  :focus-visible{
    outline: 3px solid var(--focus); 
    outline-offset: 2px; 
    border-radius: 6px;
    box-shadow: 0 0 0 1px var(--bg), 0 0 0 4px rgba(102, 204, 255, 0.2);
    transition: outline-color 0.15s ease, box-shadow 0.15s ease;
  }
  
  /* High contrast focus for buttons */
  button:focus-visible, [role="button"]:focus-visible {
    outline: 3px solid var(--focus);
    outline-offset: 2px;
    box-shadow: 0 0 0 1px var(--bg), 0 0 0 5px rgba(102, 204, 255, 0.3);
  }
  
  /* Enhanced selection styling */
  ::selection{background: rgba(0,174,240,0.3); color: var(--text)}

  /* Shared surfaces */
  .panel{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:16px}
}

@layer components{
  .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 14px;border-radius:10px;border:1px solid var(--border);background:var(--panel);color:var(--text);transition:.2s box-shadow,.2s transform}
  .btn:hover{box-shadow:0 2px 10px rgba(0,0,0,.15)}
  .btn:active{transform:translateY(1px)}
  .btn-primary{background:var(--accent);border-color:var(--accent-2);color:white}
  .btn-danger{background:var(--bad);border-color:#8e1f1f;color:white}
  .btn-warn{background:var(--warn);border-color:#8a5a00;color:black}

  label {
    display: block;
    margin-bottom: 0.5rem;
    color: var(--text-soft);
  }

  input, select, textarea {
    display: block;
    width: 100%;
    padding: 0.75rem;
    border: 1px solid var(--border);
    border-radius: 8px;
    background-color: var(--panel);
    color: var(--text);
    transition: border-color 0.2s;
  }

  input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: var(--accent);
  }

  button:disabled{cursor:not-allowed; opacity: 0.7;}

  /* Loading states and skeleton loaders */
  .loading-skeleton {
    background: linear-gradient(90deg, 
      rgba(148, 163, 184, 0.1) 25%, 
      rgba(148, 163, 184, 0.2) 50%, 
      rgba(148, 163, 184, 0.1) 75%
    );
    background-size: 200% 100%;
    animation: shimmer 1.5s ease-in-out infinite;
    border-radius: 8px;
    position: relative;
    overflow: hidden;
  }

  @keyframes shimmer {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
  }

  .loading-spinner {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 2px solid rgba(148, 163, 184, 0.3);
    border-radius: 50%;
    border-top-color: var(--accent);
    animation: spin 1s ease-in-out infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .loading-dots {
    display: inline-flex;
    gap: 4px;
  }

  .loading-dots span {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--muted);
    animation: bounce 1.4s ease-in-out infinite both;
  }

  .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
  .loading-dots span:nth-child(2) { animation-delay: -0.16s; }

  @keyframes bounce {
    0%, 80%, 100% { 
      transform: scale(0.8);
      opacity: 0.5;
    }
    40% { 
      transform: scale(1);
      opacity: 1;
    }
  }
}

@layer utilities{
  .grid{display:grid;gap:16px}
  .grid-2{grid-template-columns:repeat(2,minmax(0,1fr))}
  .grid-3{grid-template-columns:repeat(3,minmax(0,1fr))}
  
  /* Responsive breakpoints using design tokens */
  @media (max-width: 1024px){
    .grid-3{grid-template-columns:repeat(2,minmax(0,1fr))}
  }
  
  @media (max-width: 768px){
    .grid-2,.grid-3{grid-template-columns:1fr}
    .grid{gap:12px}
  }
  
  @media (max-width: 480px){
    .grid{gap:8px}
    .panel{padding:12px;border-radius:8px}
  }
  
  .fluid-img{max-width:100%;height:auto;display:block}
  .visually-hidden{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}
  
  /* Skip link styles */
  .skip-link {
    position: absolute;
    top: -40px;
    left: 6px;
    background: var(--accent);
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    z-index: 9999;
    text-decoration: none;
    transition: top 0.2s ease-in-out;
    font-weight: 500;
  }
  
  .skip-link:focus {
    top: 6px;
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    :root {
      --text: #000000;
      --bg: #ffffff;
      --border: #000000;
      --accent: #0000ee;
    }
    
    :root[data-theme='dark'] {
      --text: #ffffff;
      --bg: #000000;
      --border: #ffffff;
      --accent: #00aaff;
    }
  }

  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
    
    .loading-skeleton {
      animation: none;
      background: rgba(148, 163, 184, 0.2);
    }
  }

  /* Focus visible improvements */
  .focus-ring {
    outline: 3px solid var(--focus);
    outline-offset: 2px;
    border-radius: 6px;
    box-shadow: 0 0 0 1px var(--bg), 0 0 0 4px rgba(102, 204, 255, 0.2);
  }

  /* Ensure interactive elements have minimum touch target size */
  button, 
  [role="button"], 
  input[type="button"], 
  input[type="submit"], 
  input[type="reset"] {
    min-height: 44px;
    min-width: 44px;
  }

  /* Improve form field accessibility */
  input:invalid,
  textarea:invalid,
  select:invalid {
    border-color: var(--bad);
    box-shadow: 0 0 0 1px var(--bad);
  }

  input:invalid:focus,
  textarea:invalid:focus,
  select:invalid:focus {
    outline-color: var(--bad);
  }

  /* Design token-based spacing utilities */
  .mt-xs { margin-top: 0.25rem; }
  .mt-sm { margin-top: 0.5rem; }
  .mt-md { margin-top: 1rem; }
  .mt-lg { margin-top: 1.5rem; }
  .mt-xl { margin-top: 2rem; }
  .mt-2xl { margin-top: 2.5rem; }
  .mt-3xl { margin-top: 3rem; }
  .mt-4xl { margin-top: 4rem; }

  .mb-xs { margin-bottom: 0.25rem; }
  .mb-sm { margin-bottom: 0.5rem; }
  .mb-md { margin-bottom: 1rem; }
  .mb-lg { margin-bottom: 1.5rem; }
  .mb-xl { margin-bottom: 2rem; }
  .mb-2xl { margin-bottom: 2.5rem; }
  .mb-3xl { margin-bottom: 3rem; }
  .mb-4xl { margin-bottom: 4rem; }

  .p-xs { padding: 0.25rem; }
  .p-sm { padding: 0.5rem; }
  .p-md { padding: 1rem; }
  .p-lg { padding: 1.5rem; }
  .p-xl { padding: 2rem; }
  .p-2xl { padding: 2.5rem; }
  .p-3xl { padding: 3rem; }
  .p-4xl { padding: 4rem; }

  .gap-xs { gap: 0.25rem; }
  .gap-sm { gap: 0.5rem; }
  .gap-md { gap: 1rem; }
  .gap-lg { gap: 1.5rem; }
  .gap-xl { gap: 2rem; }
  .gap-2xl { gap: 2.5rem; }

  .text-center { text-align: center; }
}
